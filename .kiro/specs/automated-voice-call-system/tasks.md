# 実装計画

- [x] 1. プロジェクト基盤とSupabaseセットアップ
  - Next.jsプロジェクトの初期化とTypeScript設定
  - Supabaseプロジェクトの作成とデータベーステーブル作成
  - 環境変数設定とSupabaseクライアント初期化
  - _要件: 1.1, 1.2, 1.3_

- [-] 2. データモデルとバリデーション実装
  - TypeScriptインターフェースとZodスキーマの定義
  - 電話番号、IVRシナリオ、通話ログ、回答データのモデル作成
  - データバリデーション関数の実装とテスト
  - _要件: 3.1, 3.2, 5.1, 5.2_

- [ ] 3. Supabaseリアルタイム監視サービス実装
  - Supabase Realtime Subscriptionの設定
  - 新規電話番号データ検知機能の実装
  - 接続エラー時の自動再接続ロジック
  - 単体テストの作成
  - _要件: 1.1, 1.3, 1.5_

- [ ] 4. 発信管理サービス基盤実装
  - 発信キューの実装（Redis または メモリベース）
  - 同時発信数制御機能
  - 発信ステータス管理
  - 基本的な単体テスト
  - _要件: 2.1, 2.3, 2.5_

- [ ] 5. Twilio Voice API連携実装
  - Twilio SDKの設定とAPI接続
  - 基本的な発信機能の実装
  - 発信結果の処理とステータス更新
  - エラーハンドリングと再試行ロジック
  - _要件: 2.1, 2.2, 2.4_

- [ ] 6. IVRシナリオ管理サービス実装
  - シナリオのCRUD操作API
  - 質問項目と分岐条件の管理機能
  - シナリオバリデーション機能
  - Supabaseへのシナリオデータ保存
  - _要件: 3.1, 3.2, 3.4, 3.5_

- [ ] 7. Twilio Studio連携とIVRフロー生成
  - Twilio Studio APIを使用したフロー作成
  - シナリオデータからStudioフローへの変換
  - Webhookエンドポイントの設定
  - フロー更新・削除機能
  - _要件: 3.3, 4.1, 4.2, 4.4_

- [ ] 8. 回答処理サービス実装
  - Twilio WebhookのAPIエンドポイント作成
  - DTMF回答と音声録音データの処理
  - 回答データの構造化とバリデーション
  - 単体テストとWebhookテスト
  - _要件: 4.2, 4.3, 5.1_

- [ ] 9. Supabase回答データ保存機能
  - 項目別回答データのSupabase保存
  - 音声ファイルのSupabase Storage保存
  - 通話完了時のステータス更新
  - データ保存失敗時のバックアップ機能
  - _要件: 5.1, 5.2, 5.3, 5.5_

- [ ] 10. SMS通知サービス実装
  - Twilio SMS APIの設定と基本送信機能
  - 通知テンプレートの作成
  - 営業担当者への通話完了通知
  - SMS送信失敗時の再送機能
  - _要件: 6.1, 6.2, 6.5_

- [ ] 11. 管理画面基盤とダッシュボード
  - Next.jsでの管理画面レイアウト作成
  - Supabase Authを使用した認証機能
  - ダッシュボードでの発信状況表示
  - リアルタイムデータ更新機能
  - _要件: 7.1, 8.1, 8.2_

- [ ] 12. IVRシナリオ管理画面
  - シナリオ一覧・作成・編集画面
  - 質問項目と分岐条件の設定UI
  - シナリオプレビュー機能
  - バリデーションエラー表示
  - _要件: 7.2, 3.1, 3.2, 3.5_

- [ ] 13. 回答データ表示と手動発信機能
  - 項目別回答データの表形式表示
  - フィルタリングと検索機能
  - 手動発信ボタンとAPI連携
  - Supabase同期状況表示
  - _要件: 7.3, 7.4, 7.5_

- [ ] 14. エラーハンドリングと監視機能
  - 包括的なエラーログ記録
  - エラー統計とアラート機能
  - 管理画面でのエラー確認機能
  - システムヘルスチェック
  - _要件: 1.3, 2.4, 5.5, 6.5_

- [ ] 15. 統合テストとE2Eテスト
  - 電話番号登録から通知完了までのE2Eテスト
  - Supabase-Twilio連携の統合テスト
  - 管理画面操作のE2Eテスト
  - エラーシナリオのテスト
  - _要件: 全要件の統合検証_

- [ ] 16. パフォーマンス最適化と負荷テスト
  - 同時発信数制限のテスト
  - リアルタイム監視のパフォーマンス検証
  - 大量データ処理の最適化
  - メモリ使用量とレスポンス時間の監視
  - _要件: 2.5, 1.1, 5.1_

- [ ] 17. デプロイメント設定と本番環境準備
  - 本番環境用の環境変数設定
  - Vercel/Netlifyへのデプロイ設定
  - Twilio本番アカウントの設定
  - 監視とログ収集の設定
  - _要件: 8.3, 8.4_

- [ ] 18. ドキュメント作成とシステム統合
  - API仕様書の作成
  - 運用マニュアルの作成
  - 外部システム連携ガイド
  - トラブルシューティングガイド
  - _要件: 全要件のドキュメント化_